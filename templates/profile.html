{% extends "base.html" %}

{% block title %}Profile{% endblock %}

{% block content %}
    <h1>User Profile</h1>
    
    <div class="profile-info">
        <p><strong>Username:</strong> {{ user['username'] }}</p>
        <p><strong>Email:</strong> {{ user['email'] }}</p>
        {% if user['bio'] %}
            <p><strong>Bio:</strong> {{ user['bio']|safe }}</p>  <!-- Vulnerable: using |safe filter -->
        {% endif %}
    </div>
    
    <form method="POST" action="{{ url_for('update_bio') }}">
        <div class="form-group">
            <label for="bio">Update Bio:</label>
            <textarea id="bio" name="bio" class="form-control">{{ user['bio'] or '' }}</textarea>
        </div>
        <button type="submit" class="btn btn-primary">Update Bio</button>
    </form>
    
    <div class="security-note mt-4">
        <h3>Security Notes</h3>
        <p>1. This profile page is intentionally vulnerable to Insecure Direct Object Reference (IDOR).</p>
        <p>2. The bio field is vulnerable to stored XSS attacks.</p>
        <p>Try accessing other profiles by changing the user_id parameter in the URL.</p>
        <p>Try entering XSS payloads in the bio field like: <code>&lt;script&gt;alert(1)&lt;/script&gt;</code></p>
    </div>
{% endblock %}